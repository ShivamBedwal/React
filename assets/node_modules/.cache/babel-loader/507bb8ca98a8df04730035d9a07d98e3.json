{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\shiva\\\\OneDrive\\\\Desktop\\\\Capstone\\\\End-to-End Full Stack AWS Apps\\\\aws-bookstore-demo-app\\\\assets\\\\src\\\\modules\\\\checkout\\\\checkoutForm\\\\CheckoutForm.tsx\";\nimport React from \"react\";\nimport { FormGroup, FormControl, ControlLabel, Form } from \"react-bootstrap\";\nimport \"./checkoutForm.css\";\nimport supportedCards from \"../../../images/supportedCards.png\";\nimport { API } from \"aws-amplify\";\nimport { Redirect } from \"react-router\";\nexport var CheckoutForm = /*#__PURE__*/function (_React$Component) {\n  _inherits(CheckoutForm, _React$Component);\n\n  var _super = _createSuper(CheckoutForm);\n\n  function CheckoutForm(props) {\n    var _this;\n\n    _classCallCheck(this, CheckoutForm);\n\n    _this = _super.call(this, props);\n\n    _this.getOrderTotal = function () {\n      return _this.state.orders.reduce(function (total, book) {\n        return total + book.price * book.quantity;\n      }, 0).toFixed(2);\n    };\n\n    _this.handleChange = function (event) {\n      var target = event.target;\n\n      _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n        [target.name]: target.value\n      }));\n    };\n\n    _this.onCheckout = function () {\n      var orders = _this.state.orders;\n      API.post(\"orders\", \"/orders\", {\n        body: {\n          books: orders\n        }\n      }).then(function () {\n        return _this.setState({\n          toConfirm: true\n        });\n      });\n    };\n\n    _this.state = {\n      card: '1010101010101010',\n      expDate: undefined,\n      ccv: '123',\n      isLoading: true,\n      toCart: false,\n      orders: [],\n      toConfirm: false\n    };\n    return _this;\n  }\n\n  _createClass(CheckoutForm, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var orders;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.listOrdersInCart();\n\n              case 3:\n                orders = _context.sent;\n                this.setState({\n                  orders: orders\n                });\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                alert(_context.t0);\n\n              case 10:\n                this.setState({\n                  isLoading: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"listOrdersInCart\",\n    value: function listOrdersInCart() {\n      return API.get(\"cart\", \"/cart\", null);\n    }\n  }, {\n    key: \"getCardNumberValidationState\",\n    value: function getCardNumberValidationState() {\n      var length = this.state.card.length;\n      if (length >= 15 && length <= 19) return 'success';else if (length !== 0 && (length < 15 || length > 19)) return 'error';\n      return null;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.toConfirm) return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/checkout-confirm\"\n      });\n      if (this.state.isLoading) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"well-bs col-md-12 full-page no-padding-top\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"white-box no-margin-top\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"checkout \"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: supportedCards,\n        alt: \"Supported cards\"\n      }), /*#__PURE__*/React.createElement(Form, null, /*#__PURE__*/React.createElement(FormGroup, {\n        controlId: \"card\",\n        validationState: this.getCardNumberValidationState()\n      }, /*#__PURE__*/React.createElement(ControlLabel, null, \"Card number\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"card\",\n        type: \"text\",\n        value: this.state.card,\n        onChange: this.handleChange\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, null)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\"\n      }, /*#__PURE__*/React.createElement(FormGroup, {\n        controlId: \"expDate\"\n      }, /*#__PURE__*/React.createElement(ControlLabel, null, \"Expiration date\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"expDate\",\n        type: \"date\",\n        value: this.state.expDate,\n        onChange: this.handleChange\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, null)), /*#__PURE__*/React.createElement(FormGroup, {\n        className: \"ccv\",\n        controlId: \"ccv\"\n      }, /*#__PURE__*/React.createElement(ControlLabel, null, \"CCV\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"ccv\",\n        type: \"text\",\n        value: this.state.ccv,\n        onChange: this.handleChange\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, null)))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pull-right\"\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-black\",\n        type: \"button\",\n        onClick: this.onCheckout\n      }, \"Pay ($\".concat(this.getOrderTotal(), \")\"))));\n    }\n  }]);\n\n  return CheckoutForm;\n}(React.Component);\nexport default CheckoutForm;","map":{"version":3,"sources":["C:/Users/shiva/OneDrive/Desktop/Capstone/End-to-End Full Stack AWS Apps/aws-bookstore-demo-app/assets/src/modules/checkout/checkoutForm/CheckoutForm.tsx"],"names":["React","FormGroup","FormControl","ControlLabel","Form","supportedCards","API","Redirect","CheckoutForm","props","getOrderTotal","state","orders","reduce","total","book","price","quantity","toFixed","handleChange","event","target","setState","name","value","onCheckout","post","body","books","then","toConfirm","card","expDate","undefined","ccv","isLoading","toCart","listOrdersInCart","alert","get","length","getCardNumberValidationState","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { FormGroup, FormControl, ControlLabel, Form, FormControlProps } from \"react-bootstrap\";\r\n\r\nimport \"./checkoutForm.css\";\r\nimport supportedCards from \"../../../images/supportedCards.png\";\r\nimport { API } from \"aws-amplify\";\r\nimport { Redirect } from \"react-router\";\r\n\r\ninterface CheckoutFormProps {}\r\n\r\ninterface CheckoutFormState {\r\n  card: string;\r\n  expDate: string | undefined;\r\n  ccv: string;\r\n  isLoading: boolean;\r\n  toCart: boolean;\r\n  orders: any[];\r\n  toConfirm: boolean;\r\n}\r\n\r\nexport class CheckoutForm extends React.Component<CheckoutFormProps, CheckoutFormState> {\r\n  constructor(props: CheckoutFormProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      card: '1010101010101010',\r\n      expDate: undefined,\r\n      ccv: '123',\r\n      isLoading: true,\r\n      toCart: false,\r\n      orders: [],\r\n      toConfirm: false,\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    try {\r\n      const orders = await this.listOrdersInCart();\r\n      this.setState({\r\n        orders: orders\r\n      });\r\n    } catch (e) {\r\n      alert(e);\r\n    }\r\n\r\n    this.setState({ isLoading: false });\r\n  }\r\n\r\n  listOrdersInCart() {\r\n    return API.get(\"cart\", \"/cart\", null);\r\n  }\r\n\r\n  getOrderTotal = () => {\r\n    return this.state.orders.reduce((total, book) => {\r\n      return total + book.price * book.quantity\r\n    }, 0).toFixed(2);\r\n  }\r\n\r\n  getCardNumberValidationState() {\r\n    const length = this.state.card.length;\r\n    if (length >= 15 && length <= 19) return 'success';\r\n    else if (length !== 0 && (length < 15 || length > 19)) return 'error';\r\n    return null;\r\n  }\r\n\r\n  handleChange = (event: React.FormEvent<FormControl>) => {\r\n    const target = event.target as HTMLInputElement\r\n    this.setState({ \r\n      ...this.state,\r\n      [target.name as any]: target.value\r\n    });\r\n  }\r\n\r\n  onCheckout = () => {\r\n    const orders = this.state.orders;\r\n    API.post(\"orders\", \"/orders\", {\r\n      body: {\r\n        books: orders\r\n      }\r\n    }).then(() => this.setState({\r\n      toConfirm: true\r\n    }));\r\n  }\r\n\r\n  render() {\r\n    if (this.state.toConfirm) return <Redirect to='/checkout-confirm' />\r\n\r\n    if (this.state.isLoading) return null;\r\n    return (\r\n      <div className=\"well-bs col-md-12 full-page no-padding-top\">\r\n        <div className=\"white-box no-margin-top\">\r\n          <div className=\"checkout \">\r\n            <img src={supportedCards} alt=\"Supported cards\" />\r\n            <Form>\r\n              <FormGroup\r\n                controlId=\"card\"\r\n                validationState={this.getCardNumberValidationState()}>\r\n                <ControlLabel>Card number</ControlLabel>\r\n                <FormControl\r\n                  name=\"card\"\r\n                  type=\"text\"\r\n                  value={this.state.card}\r\n                  onChange={this.handleChange} />\r\n                <FormControl.Feedback />\r\n              </FormGroup>\r\n              <div className=\"form-row\">\r\n                <FormGroup\r\n                  controlId=\"expDate\">\r\n                  <ControlLabel>Expiration date</ControlLabel>\r\n                  <FormControl\r\n                    name=\"expDate\"\r\n                    type=\"date\"\r\n                    value={this.state.expDate}\r\n                    onChange={this.handleChange} />\r\n                  <FormControl.Feedback />\r\n                </FormGroup>\r\n                <FormGroup\r\n                  className=\"ccv\"\r\n                  controlId=\"ccv\">\r\n                  <ControlLabel>CCV</ControlLabel>\r\n                  <FormControl\r\n                    name=\"ccv\"\r\n                    type=\"text\"\r\n                    value={this.state.ccv}\r\n                    onChange={this.handleChange} />\r\n                  <FormControl.Feedback />\r\n                </FormGroup>\r\n              </div>\r\n            </Form>\r\n          </div>\r\n        </div>\r\n        <div className=\"pull-right\">\r\n          <button className=\"btn btn-black\" type=\"button\" onClick={this.onCheckout}>{`Pay ($${this.getOrderTotal()})`}</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CheckoutForm;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}